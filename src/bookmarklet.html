<!doctype html>
<html lang="nl-nl">
<head>
  <meta charset="UTF-8">
  
  <title>Mario-anywhere bookmarklet</title>
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <style>
  </style>
</head>
<body>
  
  Drag <a id="bookmarklet">Mario</a> to your bookmarks bar

  <script>
    const href = "javascript:void%20function(){class%20a{constructor(a,b,c){const%20d=.25*window.innerHeight,e=.75*window.innerHeight;a.Events.on(b,%22afterUpdate%22,()=%3E{const%20a=window.scrollY,b=c.position.y;if(b-a%3Cd){const%20a=c.position.y-d;window.scrollTo({top:a,behavior:%22instant%22})}else%20if(b-a%3Ee){const%20a=c.position.y-e;window.scrollTo({top:a,behavior:%22instant%22})}})}}class%20b{shapeOpacity=0;elmsUsedForBodies=[];typeCorrectionsMaps=null;constructor(a){this.Matter=a.Matter,this.canvasW=a.canvasW,this.canvasH=a.canvasH}createWallsAndGround(){const%20a=60,b={isStatic:!0,render:{opacity:this.shapeOpacity}},c={...b,render:{fillStyle:%22black%22,opacity:1}},d=this.Matter.Bodies.rectangle(this.canvasW/2,this.canvasH+25,this.canvasW,60,c),e=this.Matter.Bodies.rectangle(this.canvasW/2,-30,this.canvasW,60,b),f=this.Matter.Bodies.rectangle(-30,this.canvasH/2,60,this.canvasH,b),g=this.Matter.Bodies.rectangle(this.canvasW+30,this.canvasH/2,60,this.canvasH,b);return[d,e,f,g]}wrapTextNodeWithSpan(a){const%20b=document.createElement(%22span%22);return%20b.textContent=a.nodeValue,a.replaceWith(b),b}wrapElmTextNodesWithSpans(a,b){a.childNodes.forEach(a=%3E{const%20c=a.nodeType;if(3===c){const%20c=this.wrapTextNodeWithSpan(a);b.push(c)}else%201===c%26%26this.wrapElmTextNodesWithSpans(a,b)})}createSpansForTextNodes(a){const%20b=[];return%20a.forEach(a=%3E{const%20c=document.querySelectorAll(a);c.forEach(a=%3E{this.elmsUsedForBodies.includes(a)||this.wrapElmTextNodesWithSpans(a,b)})}),b}createWordSpans(a){const%20b=a.childNodes[0],c=b.nodeValue,d=c.split(%22%20%22),e=d.map(a=%3E{const%20b=document.createElement(%22span%22);return%20b.setAttribute(%22data-ee-char-group%22,%22regular%22),b.textContent=a+%22%20%22,b});return%20b.replaceWith(...e),e}createLineSpan(a){const%20b=document.createElement(%22span%22);return%20b.setAttribute(%22data-ee-line-group%22,%22%22),b.textContent=a,b}createLineSpans(a){const%20b=this.createWordSpans(a),c=[];let%20d=%22%22,e=null;b.forEach(a=%3E{const%20b=a.offsetTop;if(b===e)d+=a.textContent;else{if(d){const%20a=this.createLineSpan(d);c.push(a)}d=a.textContent,e=b}});const%20f=this.createLineSpan(d);return%20c.push(f),a.replaceChildren(...c),c}createCharacterGroupSpans(a){const%20b=a.childNodes[0],c=b.nodeValue,d=%22[A-Zbdfhklt']+%22,e=%22[gjpqy]+%22,f=%22[^A-Z^b^d^f^h^k^l^t^g^j^p^q^y]+%22,g=new%20RegExp(`(${d})|(${e})|(${f})`,%22g%22),h=c.match(g),i=new%20RegExp(d),j=new%20RegExp(e),k=h.map(a=%3E{let%20b=%22regular%22;a.match(i)%3Fb=%22asc%22:a.match(j)%26%26(b=%22desc%22);const%20c=document.createElement(%22span%22);return%20c.setAttribute(%22data-ee-char-group%22,b),c.textContent=a,c});return%20b.replaceWith(...k),k}getTypeCorrections(a,b){const%20c=a.getAttribute(%22data-ee-char-group%22)||%22regular%22,d=b[%22font-family%22]%3F.split(%22,%22)[0]||%22%22,e=d.toLowerCase(),f=this.typeCorrectionsMaps[e]||this.typeCorrectionsMaps.default,g=f[c],h=parseFloat(b[%22font-size%22]),i=h*g.top,j=h*g.height;return{topCorrection:i,heightCorrection:j}}createBodyForElm(a){const%20b=getComputedStyle(a),c=[b[%22border-top-left-radius%22],b[%22border-top-right-radius%22],b[%22border-bottom-right-radius%22],b[%22border-bottom-left-radius%22]],d=c.map(a=%3EparseFloat(a)),e={radius:d},f={isStatic:!0,chamfer:e,render:{fillStyle:%22red%22,opacity:this.shapeOpacity},label:%22platform%22},{width:g,height:h,top:i,left:j}=a.getBoundingClientRect();let%20k=0,l=0;if(%22SPAN%22===a.tagName){const%20c=this.getTypeCorrections(a,b);k=c.topCorrection,l=c.heightCorrection}const%20m=i+k,n=h+l,o=j+g/2,p=m+n/2,q=this.Matter.Bodies.rectangle(o,p,g,n,f);return%20this.elmsUsedForBodies.push(a),q}createBodiesForHtmlElements(){const%20a={textLevel:[%22h1%22,%22h2%22,%22h3%22,%22h4%22,%22p%22],elementLevel:[%22button%22,%22.o-card--balloon%22,%22a%22,%22th%22,%22td%22,%22input%22,%22label%22,%22img%22]},b=[];this.typeCorrectionsMaps=new%20h;const%20c=this.createSpansForTextNodes(a.textLevel);return%20c.forEach(a=%3E{const%20c=parseFloat(getComputedStyle(a).fontSize),d=24;if(c%3E=d){const%20c=this.createCharacterGroupSpans(a);c.forEach(a=%3E{b.push(this.createBodyForElm(a))})}else{const%20c=this.createLineSpans(a);c.forEach(a=%3E{b.push(this.createBodyForElm(a))})}}),a.elementLevel.forEach(a=%3E{const%20c=document.querySelectorAll(a);c.forEach(a=%3E{const%20c=a.childNodes;if(1===c.length%26%263===c[0].nodeType){const%20a=this.wrapTextNodeWithSpan(c[0]);b.push(this.createBodyForElm(a))}else%20b.push(this.createBodyForElm(a))})}),b}}class%20c{platformsAreVisible=!1;constructor(a){this.render=a;const%20b=this.addRevealButton();b.addEventListener(%22click%22,()=%3E{b.blur(),this.togglePlatformVisibility()})}addRevealButton(){const%20a=%22mario-platform-revealer%22;document.getElementById(%22mario-platform-revealer%22)%3F.remove();const%20b=document.createElement(%22button%22);b.id=%22mario-platform-revealer%22,b.textContent=%22%3F%22,b.title=%22Toggle%20platform%20visibility%22,document.body.appendChild(b);const%20c={position:%22fixed%22,display:%22flex%22,justifyContent:%22center%22,alignItems:%22center%22,top:%2240px%22,right:%225px%22,width:%221.5rem%22,height:%221.5rem%22,borderRadius:%2250%25%22,background:%22black%22,border:%22none%22,color:%22white%22,opacity:.2,zIndex:1e6};for(const%20a%20in%20c)b.style[a]=c[a];return%20b}togglePlatformVisibility(){this.platformsAreVisible=!this.platformsAreVisible;const%20a=this.platformsAreVisible%3F.2:0;this.render.engine.world.bodies.forEach(b=%3E{%22platform%22===b.label%26%26(b.render.opacity=a)})}}const%20d={stand:%22stand%22,jump:%22jump%22,walk:%22walk%22,fall:%22fall%22,brake:%22brake%22};class%20e{isInTheAir=!0;playerBody=null;playerSpriteBody=null;lastDir=1;walkCycleIdx=0;walkUpdateIdx=0;walkUpdateEveryNth=5;accelerationX=.25;maxSpeedX=5;totalJumpForce=0;maxJumpForce=.045;keyLeftIsDown=!1;keyRightIsDown=!1;keySpaceIsDown=!1;keySpaceWasUpAfterJumpStart=!1;constructor(a,b,c){this.engine=a,this.render=b,this.walkCycleLength=c.walk.l.length,this.SPRITES=c,this.createBody(),this.initCollisionDetection(),this.initKeyboardControls(),Matter.Events.on(a,%22afterUpdate%22,()=%3E{this.updateHandler()})}createPlayerSpriteBody(a,b,c){const%20d={label:%22playerShape%22,render:{sprite:{texture:this.SPRITES.stand.r,xScale:1,yScale:1}}},e=Matter.Bodies.rectangle(a,b,c,c,d);return%20e}createFloorSensorBody(a,b,c){const%20d=c-4,e=10,f={label:%22floorSensor%22,render:{fillStyle:%22transparent%22}},g=Matter.Bodies.rectangle(a,b+c/2-e/2,d,e,f);return%20g}createBody(){const%20a=32,b=this.render.options.width/2-250,c=17;this.playerSpriteBody=this.createPlayerSpriteBody(b,c,32);const%20d=this.createFloorSensorBody(b,c,32);this.playerBody=Matter.Body.create({label:%22player%22,parts:[this.playerSpriteBody,d],restitution:0,friction:0,frictionAir:0,inertia:1/0,mass:1})}checkInTheAir(a){a.pairs.forEach(a=%3E{let%20b;%22floorSensor%22===a.bodyA.label%3Fb=a.bodyA:%22floorSensor%22===a.bodyB.label%26%26(b=a.bodyB),b%26%26(this.removeActiveCollisionDetection(),this.isInTheAir=!1,this.totalJumpForce=this.maxJumpForce)})}removeActiveCollisionDetection(){Matter.Events.off(this.engine,%22collisionActive%22)}addActiveCollisionDetection(){Matter.Events.on(this.engine,%22collisionActive%22,a=%3E{this.checkInTheAir(a)})}initCollisionDetection(){this.addActiveCollisionDetection(),Matter.Events.on(this.engine,%22collisionEnd%22,()=%3E{this.isInTheAir=!0,this.addActiveCollisionDetection()})}getXSpeed(){return%20Matter.Body.getVelocity(this.playerBody).x}setXSpeed(a){const%20b=Matter.Body.getVelocity(this.playerBody).y;Matter.Body.setVelocity(this.playerBody,{x:a,y:b})}applyForceUp(a){const%20c=-1*a,d=this.playerBody;Matter.Body.applyForce(d,{x:d.position.x,y:d.position.y},{x:0,y:c})}jump(){if(!this.isInTheAir){const%20a=.03;this.applyForceUp(a),this.totalJumpForce=a,this.keySpaceWasUpAfterJumpStart=!1}}moveX(a){this.setXSpeed(10*a)}updateSpeedX(){var%20a=Math.min,b=Math.max;let%20c=0;const%20d=this.getXSpeed();this.keyLeftIsDown%3F(c=d-this.accelerationX,c=b(c,-1*this.maxSpeedX)):this.keyRightIsDown%3F(c=d+this.accelerationX,c=a(c,this.maxSpeedX)):0%3Ed%3F(c=d+this.accelerationX,c=a(c,0)):0%3Cd%26%26(c=d-this.accelerationX,c=b(c,0)),this.setXSpeed(c),0!==c%26%26(this.lastDir=c/Math.abs(c))}updateForceY(){if(this.keySpaceIsDown%26%26this.isInTheAir%26%26!this.keySpaceWasUpAfterJumpStart){const%20a=this.maxJumpForce-this.totalJumpForce,b=5e-4;a%3E=b%26%26(this.applyForceUp(b),this.totalJumpForce+=b)}}initKeyboardControls(){document.body.addEventListener(%22keydown%22,a=%3E{const%20b=a.code;%22Space%22===b%3F(a.preventDefault(),this.keySpaceIsDown=!0,this.jump()):%22ArrowLeft%22===b%3Fthis.keyLeftIsDown=!0:%22ArrowRight%22===b%3Fthis.keyRightIsDown=!0:void%200}),document.body.addEventListener(%22keyup%22,a=%3E{const%20b=a.code;%22Space%22===b%3F(this.keySpaceIsDown=!1,this.keySpaceWasUpAfterJumpStart=!0):%22ArrowLeft%22===b%3Fthis.keyLeftIsDown=!1:%22ArrowRight%22===b%3Fthis.keyRightIsDown=!1:void%200})}getWalkTexture(a){if(0%3Ca%26%26this.keyLeftIsDown)return%20this.SPRITES.brake.l;if(0%3Ea%26%26this.keyRightIsDown)return%20this.SPRITES.brake.r;0===this.walkUpdateIdx%26%26(this.walkCycleIdx++,this.walkCycleIdx===this.walkCycleLength%26%26(this.walkCycleIdx=0)),this.walkUpdateIdx++,this.walkUpdateIdx===this.walkUpdateEveryNth%26%26(this.walkUpdateIdx=0);const%20b=this.mapSpeedToLetter(a);return%20this.SPRITES.walk[b][this.walkCycleIdx]}mapSpeedToLetter(a){return%200%3Ea%3F%22l%22:%22r%22}setSprite(a,b){const%20c=this.playerSpriteBody.render.sprite.texture;let%20e;const%20f=this.mapSpeedToLetter(this.lastDir);a===d.stand%3Fe=this.SPRITES.stand[f]:a===d.jump%3Fe=this.SPRITES.jump[f]:a===d.fall%3Fe=this.SPRITES.fall:a===d.walk%3Fe=this.getWalkTexture(b):void%200;e%26%26e!==c%26%26(this.playerSpriteBody.render.sprite.texture=e)}updateSprite(){const%20a=this.getXSpeed();this.isInTheAir%3Fthis.setSprite(d.jump,a):0===a%3Fthis.setSprite(d.stand,a):this.setSprite(d.walk,a)}updateHandler(){this.updateSpeedX(),this.updateForceY(),this.updateSprite()}}class%20f{playerSprites=[%22r-stand.png%22,%22r-1.png%22,%22r-2.png%22,%22r-3.png%22,%22r-jump.png%22,%22r-brake.png%22,%22l-stand.png%22,%22l-1.png%22,%22l-2.png%22,%22l-3.png%22,%22l-jump.png%22,%22l-brake.png%22,%22fall.png%22];spriteImages=[...this.playerSprites];constructor(a){this.baseUrl=a,this.preloadSprites(),this.SPRITES=this.createActionSprites()}p(a){const%20b=%22mario/%22;return%20this.baseUrl+%22mario/%22+a}preloadSprites(){const%20a=%22sprite-preloader%22;if(!document.getElementById(%22sprite-preloader%22)){const%20b=document.createElement(%22div%22);b.id=a,b.style.display=%22none%22,this.spriteImages.forEach(a=%3E{const%20c=document.createElement(%22img%22);c.src=this.p(a),b.appendChild(c)}),document.body.appendChild(b)}}createActionSprites(){return{stand:{l:this.p(%22l-stand.png%22),r:this.p(%22r-stand.png%22)},jump:{l:this.p(%22l-jump.png%22),r:this.p(%22r-jump.png%22)},brake:{l:this.p(%22l-brake.png%22),r:this.p(%22r-brake.png%22)},walk:{l:[this.p(%22l-1.png%22),this.p(%22l-2.png%22),this.p(%22l-3.png%22)],r:[this.p(%22r-1.png%22),this.p(%22r-2.png%22),this.p(%22r-3.png%22)]},fall:this.p(%22fall.png%22)}}}class%20g{constructor(a){const%20b={totalHeight:44,ascTop:8,ascHeight:29,regularTop:16,regularHeight:21,descHeight:29},c=Object.assign(b,a),d={top:c.regularTop/c.totalHeight,height:(c.regularHeight-c.totalHeight)/c.totalHeight},e={top:c.ascTop/c.totalHeight,height:(c.ascHeight-c.totalHeight)/c.totalHeight},f={top:c.regularTop/c.totalHeight,height:(c.descHeight-c.totalHeight)/c.totalHeight};return{regular:d,asc:e,desc:f}}}class%20h{configs={default:null,helveticaneue:{totalHeight:48,ascTop:0,ascHeight:34,regularTop:9,regularHeight:25,descHeight:34}};constructor(){const%20a={};for(const%20b%20in%20this.configs){const%20c=this.configs[b];a[b]=new%20g(c)}return%20a}}let%20i,j,k,l,m,n,o;const%20p=%22mario-canvas-container%22;let%20q,r=0,s=0;const%20t=()=%3E{({Composite:i,Engine:j,Render:k,Runner:l}=Matter)},u=()=%3E{n=k.create({element:o,engine:m,options:{width:r,height:s,wireframes:!1,background:%22transparent%22}}),o.querySelector(%22canvas%22).style.pointerEvents=%22none%22},v=a=%3E{const%20c={Matter,canvasW:r,canvasH:s},d=new%20b(c),f=d.createWallsAndGround(),g=d.createBodiesForHtmlElements();q=new%20e(m,n,a).playerBody;const%20h=[...f,...g,q];i.add(m.world,h)},w=()=%3E{const%20a=document.body.parentNode;a.style.minHeight=%22100%25%22,a.style.height=%22auto%22,document.body.style.minHeight=%22100dvh%22,document.body.style.height=%22auto%22},x=()=%3E{const%20a=document.createElement(%22style%22);document.head.appendChild(a);const%20b=a.sheet;b.insertRule(`%23${p}%20canvas%20{%20display:%20block;%20}`)},y=()=%3E{r=document.body.offsetWidth,s=document.body.offsetHeight,o=document.createElement(%22div%22),o.id=p;const%20a={position:%22absolute%22,top:0,left:0,height:0,width:0,zIndex:1e16};for(const%20b%20in%20a)o.style[b]=a[b];document.body.appendChild(o)},z=()=%3E{w(),x(),y()},A=a=%3E{z(),m=j.create();const%20b=new%20f(a);u(),v(b.SPRITES);const%20c=l.create();l.run(c,m),k.run(n)},B=()=%3E{Matter=null,document.getElementById(p)%3F.remove(),E()},C=()=%3E{document.body.addEventListener(%22reset.easterEggGame%22,B,{once:!0})},D=()=%3E{const%20a=new%20Promise((a,b)=%3E{const%20c=%22https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js%22,d=document.createElement(%22script%22);d.src=%22https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.19.0/matter.min.js%22,d.addEventListener(%22load%22,a),d.addEventListener(%22error%22,a=%3Eb(a)),document.body.appendChild(d)});return%20a},E=()=%3E{const%20b=%22https://jaron.nl/playground/mario-anywhere/sprites/%22;D().then(()=%3E{window.scrollTo({top:0,behavior:%22instant%22}),t(),A(b),C(),new%20a(Matter,m,q),new%20c(n)}).catch(a=%3E{console.log(%22can%20not%20load%22,a)})};console.clear(),E()}();";

    document.getElementById('bookmarklet').href = href;
  </script>
</body>
</html>
